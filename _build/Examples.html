
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

    <title>Overview &#8212; splotch 0.5.6.6 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Changelog for Splotch" href="changelog.html" />
    <link rel="prev" title="splotch base functions" href="base_func.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="changelog.html" title="Changelog for Splotch"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="base_func.html" title="splotch base functions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">splotch 0.5.6.6 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Overview</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Overview">
<h1>Overview<a class="headerlink" href="#Overview" title="Permalink to this headline">¶</a></h1>
<p>Simple PLOTs, Contours and Histograms is a small package with wrapper functions designed to facilitate simplified, concise calls to matplotlib plotting.</p>
<section id="The-Basics">
<h2>The Basics<a class="headerlink" href="#The-Basics" title="Permalink to this headline">¶</a></h2>
<p>The general mantra of Splotch is that most plotting functions should require only a single line of code to manifest, rather than requiring the user to manually specify each aspect of a plot individually. This is taken in a two-fold approach, both in terms of minimising the amount of pre-processing of data needed to produce common scientific plots as well as incorporating the visual modifications (e.g. <code class="docutils literal notranslate"><span class="pre">axes.set_xlim()</span></code>, <code class="docutils literal notranslate"><span class="pre">axes.set_title()</span></code>, <code class="docutils literal notranslate"><span class="pre">axes.set_xlabel()</span></code> ) directly into function
calls. Splotch is designed to be a superset of matplotlib.pyplot, given you all the functionality that you already know and “love”, plus some useful, intuitive shortcuts for improved quality-of-life.</p>
<p>Splotch functions can be broken down into a set of distinct types:</p>
<ul class="simple">
<li><p><strong>1-Dimensional Plots</strong>: Plotting functions that can generally be defined as having one independent axis, e.g. <code class="docutils literal notranslate"><span class="pre">splotch.plot()</span></code>, <code class="docutils literal notranslate"><span class="pre">splotch.hist()</span></code>, <code class="docutils literal notranslate"><span class="pre">splotch.curve()</span></code>.</p></li>
<li><p><strong>2-Dimensional Plots</strong>: Plotting functions that have an additional independent axis and generally show a third quantity as a color axis, e.g. <code class="docutils literal notranslate"><span class="pre">splotch.hist2D()</span></code>, <code class="docutils literal notranslate"><span class="pre">splotch.contourp()</span></code>.</p></li>
<li><p><strong>Axis functions</strong>: Plots that act upon the axes of a matplotlib figure rather than producing a specific plot, e.g. <code class="docutils literal notranslate"><span class="pre">splotch.colorbar()</span></code>, <code class="docutils literal notranslate"><span class="pre">splotch.adjust_text()</span></code>.</p></li>
</ul>
</section>
<section id="1-Dimensional-Plots">
<h2>1-Dimensional Plots<a class="headerlink" href="#1-Dimensional-Plots" title="Permalink to this headline">¶</a></h2>
<section id="A-Simple-plot-using-matplotlib">
<h3>A Simple plot using matplotlib<a class="headerlink" href="#A-Simple-plot-using-matplotlib" title="Permalink to this headline">¶</a></h3>
<p>The simplest plot one can make is a series of y data against some x data. Producing this in <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> might look something like the following for a typical user.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import some standard libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create some fake data</span>
<span class="n">rng</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">xdata</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">10.0</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="o">+</span><span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="o">/</span><span class="mf">10.0</span>
<span class="n">ydata</span><span class="o">=</span><span class="n">xdata</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">xdata</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">20.0</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">cdata</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">xdata</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.2</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1">#####  MATPLOTLIB USAGE  #####</span>
<span class="c1">#--------------------------------------------------------#</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x data&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y data&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;A Simple Plot&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#--------------------------------------------------------#</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_6_0.png" src="_images/Examples_6_0.png" />
</div>
</div>
<p>Using Splotch, we can replicate the above matplotlib plot in just a single call to <code class="docutils literal notranslate"><span class="pre">splotch.plot()</span></code>.</p>
<p><strong>Same outcome, in a single line</strong>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># import SPLOTCH</span>
<span class="kn">import</span> <span class="nn">splotch</span> <span class="k">as</span> <span class="nn">splt</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1">#####  SPLOTCH USAGE  #####</span>
<span class="c1">#--------------------------------------------------------#</span>
<span class="n">splt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x data&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;y data&quot;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;A Simple Plot&quot;</span><span class="p">,</span><span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#--------------------------------------------------------#</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_9_0.png" src="_images/Examples_9_0.png" />
</div>
</div>
</section>
<section id="Basic-histograms">
<h3>Basic histograms<a class="headerlink" href="#Basic-histograms" title="Permalink to this headline">¶</a></h3>
<p>The same goes for producing basic 1D histograms with SPLOTCH - one line is all it takes. There are also some useful ways to assign binning of the histrogram.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create an array with some random distribution</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">axes1</span><span class="p">,</span> <span class="n">axes2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>


<span class="c1">#####  MATPLOTLIB USAGE  #####</span>
<span class="c1">#--------------------------------------------------------#</span>
<span class="n">axes1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">)</span>

<span class="n">axes1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axes1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">axes1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axes1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Some Data&quot;</span><span class="p">)</span>
<span class="n">axes1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Normalised Counts&quot;</span><span class="p">)</span>
<span class="n">axes1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;matplotlib.pyplot usage&quot;</span><span class="p">)</span>
<span class="c1">#--------------------------------------------------------#</span>


<span class="c1">#####  SPLOTCH USAGE  #####</span>
<span class="c1">#--------------------------------------------------------#</span>
<span class="n">splt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axes2</span><span class="p">,</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span><span class="n">dens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Some Data&quot;</span><span class="p">,</span>
          <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Normalised Counts&quot;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;SPLOTCH usage&quot;</span><span class="p">,</span><span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#--------------------------------------------------------#</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_12_0.png" src="_images/Examples_12_0.png" />
</div>
</div>
<p>Aside from encapsulating every aspect of the plot in a single line, <code class="docutils literal notranslate"><span class="pre">splotch.hist()</span></code> also grants some extra functionality on top of the standard <code class="docutils literal notranslate"><span class="pre">matplotlib.hist()</span></code>.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">hist_type</span></code>, the histogram can be drawn in three different styles: <code class="docutils literal notranslate"><span class="pre">step</span></code> (based on <code class="docutils literal notranslate"><span class="pre">pyplot.step</span></code>), <code class="docutils literal notranslate"><span class="pre">line</span></code> (<code class="docutils literal notranslate"><span class="pre">pyplot.plot</span></code>) and <code class="docutils literal notranslate"><span class="pre">bar</span></code> (<code class="docutils literal notranslate"><span class="pre">pyplot.bar</span></code>). Furthermore, each one of these has a filled varient, adding <code class="docutils literal notranslate"><span class="pre">filled</span></code> to the type name (e.g., <code class="docutils literal notranslate"><span class="pre">stepfilled</span></code>).</p>
<p>Besides the standard options of specifying bins by either number, width or edges, there is the option <code class="docutils literal notranslate"><span class="pre">bin_type</span></code> which, when set to <code class="docutils literal notranslate"><span class="pre">equal</span></code>, automatically produces a binning scheme where each bin has approximately the same number of elements. Note that this options, while sensible when using <code class="docutils literal notranslate"><span class="pre">dens=True</span></code> for high sampling of dense regions while avoiding noisy results in sparse regions, is quite uninformative when used for raw counts (<code class="docutils literal notranslate"><span class="pre">dens=False</span></code>).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">cumul=True</span></code>, this will instead produce a cumulative histogram. Finally, the <code class="docutils literal notranslate"><span class="pre">scale</span></code> parameter allows the scaling up/down of values in the resulting histogram. Note that in combination with <code class="docutils literal notranslate"><span class="pre">dens=True</span></code> it changes the type of histogram shown, from a PDF to histogram where (if <code class="docutils literal notranslate"><span class="pre">scale=1</span></code>) the area under the curve equates to the number of datapoints.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">### Histogram types</span>
<span class="n">splt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">dens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hist_type</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Filled&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">splt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">dens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hist_type</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">splt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">dens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hist_type</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolated&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1">### Binning types</span>
<span class="n">splt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">dens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Equal binning&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

<span class="c1">### Cumulative histogram</span>
<span class="n">splt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">dens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cumul</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">5500</span><span class="p">,</span> <span class="n">hist_type</span><span class="o">=</span><span class="s1">&#39;linefilled&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cumulative (scaled)&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
          <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x data&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_14_0.png" src="_images/Examples_14_0.png" />
</div>
</div>
</section>
<section id="Broken-axis-plots">
<h3>Broken axis plots<a class="headerlink" href="#Broken-axis-plots" title="Permalink to this headline">¶</a></h3>
<p>Sometimes you wish to plot some data that has a discontinuity at some point, but to plotting it on one axis stretches the limits of the axis. Instead, placing a break in the plot can highlight the low and high regimes of the data without sacrificing the stretch on the limits.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">xbroken</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mf">0.02</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">20.0</span><span class="p">,</span><span class="mf">30.0</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mf">0.02</span><span class="p">))</span>
<span class="n">ybroken</span> <span class="o">=</span> <span class="n">xbroken</span><span class="o">**</span><span class="mf">0.5</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">xbroken</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span><span class="n">axes</span><span class="o">=</span><span class="n">splt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">splt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xbroken</span><span class="p">,</span> <span class="n">ybroken</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Broken x data&#39;</span><span class="p">,</span>
          <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;y data&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">splt</span><span class="o">.</span><span class="n">brokenplot</span><span class="p">(</span><span class="n">xbroken</span><span class="p">,</span><span class="n">ybroken</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">xbreak</span><span class="o">=</span><span class="p">[</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">19.5</span><span class="p">],</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Broken x data&#39;</span><span class="p">,</span>
                <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;y data&quot;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_17_0.png" src="_images/Examples_17_0.png" />
</div>
</div>
</section>
<section id="Axis-lines-and-Curves">
<h3>Axis lines and Curves<a class="headerlink" href="#Axis-lines-and-Curves" title="Permalink to this headline">¶</a></h3>
<section id="The-generalised-axline-function">
<h4>The generalised axline function<a class="headerlink" href="#The-generalised-axline-function" title="Permalink to this headline">¶</a></h4>
<p>Often, one wishes to overplot a single line such as a straight vertical or horizontal line on a plot, or sometimes a diagonal line such as a one-to-one line. Indeed, matplotlib provides the <code class="docutils literal notranslate"><span class="pre">axhline</span></code> and <code class="docutils literal notranslate"><span class="pre">axvline</span></code> functions, but this doees not provide the generalised functionality needed for a diagonal line, nor do they allow the user to plot multiple offset lines simultaneously.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">splotch.axline()</span></code> function allows the user to specify either the <code class="docutils literal notranslate"><span class="pre">x</span></code> or <code class="docutils literal notranslate"><span class="pre">y</span></code> value(s) for a vertical or horizontal line, respectively, or, in the more generalised case of a diagonal line defined by the function <span class="math notranslate nohighlight">\(y = a*x + b\)</span>, where <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are the slope and intercept, respectively. Some examples are shown below:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">splt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Plot a single horizontal line</span>
<span class="n">splt</span><span class="o">.</span><span class="n">axline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Plot multiple vertical lines at the same time</span>
<span class="n">splt</span><span class="o">.</span><span class="n">axline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;test x&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;test y&quot;</span><span class="p">)</span>

<span class="c1"># Plot some diagonal lines and modify some of the axis appearance at the same time</span>
<span class="n">splt</span><span class="o">.</span><span class="n">axline</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;test x&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;test y&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a = 1&quot;</span><span class="p">,</span><span class="s2">&quot;a = 2&quot;</span><span class="p">,</span><span class="s2">&quot;a = 3&quot;</span><span class="p">],</span>
            <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_19_0.png" src="_images/Examples_19_0.png" />
</div>
</div>
</section>
</section>
<section id="Generalised-curves-based-on-expressions">
<h3>Generalised curves based on expressions<a class="headerlink" href="#Generalised-curves-based-on-expressions" title="Permalink to this headline">¶</a></h3>
<p>Often, the curves we wish to plot are not straight lines but are curves defined by a mathematical expression with a dependent and independent variable, e.g.</p>
<p><span class="math notranslate nohighlight">\(y = 4*x^2\)</span></p>
<p><span class="math notranslate nohighlight">\(L = 4\times 10^{-21}(1+z)\,e^{-\nu}\)</span></p>
<p>$(y^2 + x^2 - 1)^3 - x^2 y^3 = 0 $, and so on.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">splotch.curve()</span></code> function can be used to plot a python function or a mathematical expression denoted as a string (e.g. expr=“4*x^2”) as a curve that can modified exactly like a line in the examples above for <code class="docutils literal notranslate"><span class="pre">splotch.axline()</span></code>. An expression requires at least one independent variable (‘x’ by default, but can be changed using the ‘var’ parameter) and can optionally include any number of substitution variables (as in ‘b’ in the example below). A substitution variable is a place holder
that will result in as many lines as the number of values provided in the <code class="docutils literal notranslate"><span class="pre">subs</span></code> argument.</p>
<p>Note, that if your expression contains substitution variables, then you must provide the corresponding value(s) for these in <code class="docutils literal notranslate"><span class="pre">subs</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Create some mock data for the function y = 3x^2 + 5</span>
<span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">ydata</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">xdata</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span> <span class="c1"># + noise</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">splt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="c1">## First plot the data</span>
<span class="n">splt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;f(x)&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>

<span class="c1">## Now use splotch.curve() to create a curve for the expression y = 3x^2 + b</span>
<span class="n">splt</span><span class="o">.</span><span class="n">curve</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="s1">&#39;3*x^2 + b&#39;</span><span class="p">,</span><span class="n">subs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
           <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">## Use bounds to specify the region in x over which the function should be plotted</span>
<span class="c1">## and give multiple values for the substitution variable, b</span>
<span class="n">splt</span><span class="o">.</span><span class="n">curve</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="s1">&#39;3*x^2 + b&#39;</span><span class="p">,</span><span class="n">subs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">]),</span><span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">55</span><span class="p">),</span>
           <span class="n">linestyle</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_22_0.png" src="_images/Examples_22_0.png" />
</div>
</div>
<p>Or equivalently, one could define a function which returns the result of the expression for any value in x.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span>

<span class="c1">## Input expression as a python function instead</span>
<span class="n">splt</span><span class="o">.</span><span class="n">curve</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">func</span><span class="p">,</span><span class="n">subs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">55</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;func(x, b=5)&quot;</span><span class="p">,</span>
           <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_24_0.png" src="_images/Examples_24_0.png" />
</div>
</div>
<p>There are lots of additional functionalities included in splotch.curve() including the ability to produce lines for every permutation of substitution variables using <code class="docutils literal notranslate"><span class="pre">permute=True</span></code>. The similarly structured <code class="docutils literal notranslate"><span class="pre">splotch.curve_piecewise()</span></code> can be used if instead you wish to plot a curve that is defined by different expressions in different regions.</p>
</section>
</section>
<section id="2-Dimensional-Plots">
<h2>2-Dimensional Plots<a class="headerlink" href="#2-Dimensional-Plots" title="Permalink to this headline">¶</a></h2>
<section id="2D-Images-and-Colorbars">
<h3>2D Images and Colorbars<a class="headerlink" href="#2D-Images-and-Colorbars" title="Permalink to this headline">¶</a></h3>
<p>Splotch has a fairly simple wrapper around the currently available <code class="docutils literal notranslate"><span class="pre">pyplot.imshow()</span></code> (or <code class="docutils literal notranslate"><span class="pre">pyplot.matshow()</span></code>) function but with some additional useful utilities.</p>
<p>Furthermore, color bars that map the color-axis to a set of quantities can often be tedious to create in matplotlib usage. In Splotch, you can turn on color bars within most 2D functions simply by setting <code class="docutils literal notranslate"><span class="pre">clabel</span></code> and can also make use of paramters such as <code class="docutils literal notranslate"><span class="pre">clog</span></code>, <code class="docutils literal notranslate"><span class="pre">clim</span></code>, <code class="docutils literal notranslate"><span class="pre">cmap</span></code>, <code class="docutils literal notranslate"><span class="pre">cbar_invert</span></code>, etc.</p>
<p>Alternatively, one can make use of the <code class="docutils literal notranslate"><span class="pre">splotch.colorbar()</span></code> which gives the user far more control over the positioning of your colorbar.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">### Create an image of a 2D Gaussian</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="p">))</span>
<span class="n">img</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">X</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">*</span> <span class="mf">2.0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span><span class="n">axes</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">splt</span><span class="o">.</span><span class="n">img</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">clim</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;magma&quot;</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x [pixels]&quot;</span><span class="p">,</span>
         <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;y [pixels]&quot;</span><span class="p">)</span>

<span class="n">splt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;$z = 5*e^{-(x^2 + y^2)</span><span class="se">\\</span><span class="s2">sigma^2/2}$&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_29_0.png" src="_images/Examples_29_0.png" />
</div>
</div>
</section>
<section id="Scatter-Plots">
<h3>Scatter Plots<a class="headerlink" href="#Scatter-Plots" title="Permalink to this headline">¶</a></h3>
<p>Here is a general usage of the <code class="docutils literal notranslate"><span class="pre">splotch.scatter()</span></code> function, which generally takes both <code class="docutils literal notranslate"><span class="pre">xdata</span></code> and <code class="docutils literal notranslate"><span class="pre">ydata</span></code> as well as <code class="docutils literal notranslate"><span class="pre">cdata</span></code>, the information required for plotting on the color-axis.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create some data representing two multi-variate 2D Gaussians, the details are not improtant here.</span>
<span class="n">num</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">xvals</span><span class="p">,</span> <span class="n">yvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span><span class="n">size</span><span class="o">=</span><span class="n">num</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>  <span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span><span class="n">size</span><span class="o">=</span><span class="n">num</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">cvals</span> <span class="o">=</span> <span class="p">(</span><span class="n">xvals</span><span class="o">+</span><span class="n">yvals</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">xvals</span><span class="p">))</span> <span class="c1"># The color-axis quantities</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="c1"># Use the color-axis quatinies</span>
<span class="n">splt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xvals</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">yvals</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cvals</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
             <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x data&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;y data&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="c1"># Instead let the color-axis represent the number density at each point</span>
<span class="n">splt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xvals</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">yvals</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
             <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x data&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;y data&quot;</span><span class="p">,</span> <span class="n">clabel</span><span class="o">=</span><span class="s2">&quot;Number density&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cividis&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_32_0.png" src="_images/Examples_32_0.png" />
</div>
</div>
</section>
<section id="2D-Histograms">
<h3>2D Histograms<a class="headerlink" href="#2D-Histograms" title="Permalink to this headline">¶</a></h3>
<p>With Splotch, binning two-dimensional data to produce density distributions or calculating statistics (e.g. mean, median, sum) simultaneously across two axes has never been easier! Simply passing your x and y data into <code class="docutils literal notranslate"><span class="pre">splotch.hist2D(</span> <span class="pre">)</span></code> will provide all the necessary functionality of working with 2-dimensional data. Let’s use the same data from the scatter plot tutorial.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span><span class="n">axes</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">14</span><span class="p">))</span>

<span class="c1"># A set number of bins across both axes</span>
<span class="n">splt</span><span class="o">.</span><span class="n">hist2D</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">yvals</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x data&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;y data&quot;</span><span class="p">,</span>
            <span class="n">clabel</span><span class="o">=</span><span class="s2">&quot;Number density&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Shared Number of Bins&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Different numbers of bins for each axis</span>
<span class="n">splt</span><span class="o">.</span><span class="n">hist2D</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">yvals</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span> <span class="n">dens</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x data&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;y data&quot;</span><span class="p">,</span>
            <span class="n">clabel</span><span class="o">=</span><span class="s2">&quot;Number count&quot;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Different Number of Bins&quot;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Array defining arbitrarily-spaced bin edges (e.g. logarithmic below)</span>
<span class="n">splt</span><span class="o">.</span><span class="n">hist2D</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">yvals</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cvals</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="n">dens</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">75</span><span class="p">),</span>
            <span class="n">clog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xlog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ylog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x data&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;y data&quot;</span><span class="p">,</span>
            <span class="n">cstat</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">clabel</span><span class="o">=</span><span class="s2">&quot;mean values&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Logarithmically-Spaced Bin Edges&quot;</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/00092380/opt/anaconda3/lib/python3.8/site-packages/splotch/base_func.py:176: RuntimeWarning: invalid value encountered in log10
  data=log10(data)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_34_1.png" src="_images/Examples_34_1.png" />
</div>
</div>
<section id="Binned-statistics-in-one-and-two-dimensional-histograms">
<h4>Binned statistics in one and two-dimensional histograms<a class="headerlink" href="#Binned-statistics-in-one-and-two-dimensional-histograms" title="Permalink to this headline">¶</a></h4>
<p>Both <code class="docutils literal notranslate"><span class="pre">splotch.hist</span></code> and <code class="docutils literal notranslate"><span class="pre">splotch.hist2D</span></code> provide the option of making binned statistics. This is done passing the kwarg <code class="docutils literal notranslate"><span class="pre">v</span></code> or <code class="docutils literal notranslate"><span class="pre">c</span></code>, respectively. The kwarg <code class="docutils literal notranslate"><span class="pre">vstat</span></code>/<code class="docutils literal notranslate"><span class="pre">cstat</span></code> control the type of statistic to be used, and accepts the same inputs as <code class="docutils literal notranslate"><span class="pre">scipy.stats.binned_statistic</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">splt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="c1">## Get the median and mean values in bins along the x-axis</span>
<span class="n">splt</span><span class="o">.</span><span class="n">hist</span><span class="p">([</span><span class="n">x</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
          <span class="n">vstat</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;median&#39;</span><span class="p">,</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Median&#39;</span><span class="p">,</span><span class="s1">&#39;Mean&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">],</span>
          <span class="n">linestyle</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dotted&#39;</span><span class="p">,</span><span class="s1">&#39;dashed&#39;</span><span class="p">])</span>

<span class="c1"># Plot the 2-dimensional histogram in the background</span>
<span class="n">splt</span><span class="o">.</span><span class="n">hist2D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="n">clabel</span><span class="o">=</span><span class="s1">&#39;Point density&#39;</span><span class="p">)</span>

<span class="c1">## Binned statistics in 2-dimension</span>
<span class="n">splt</span><span class="o">.</span><span class="n">hist2D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">z</span> <span class="p">,</span><span class="n">cstat</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">clabel</span><span class="o">=</span><span class="s1">&#39;Median value of $z(x,y)$&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_37_0.png" src="_images/Examples_37_0.png" />
</div>
</div>
</section>
</section>
<section id="Contour-plots">
<h3>Contour plots<a class="headerlink" href="#Contour-plots" title="Permalink to this headline">¶</a></h3>
<section id="Percentile-Contour-Plots:">
<h4>Percentile Contour Plots:<a class="headerlink" href="#Percentile-Contour-Plots:" title="Permalink to this headline">¶</a></h4>
<p>Given some x and y data, a percentile contour plot will create contours around specified percentiles of the density distribution in two dimensions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span><span class="n">axes</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="c1"># Basic percentile contours enclosing 68% (~1 sigma) and 95% (~2 sigma) of the data.</span>
<span class="n">splt</span><span class="o">.</span><span class="n">contourp</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">yvals</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span> <span class="n">xinvert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">yinvert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span>
              <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x data (inverted)&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;y data&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_39_0.png" src="_images/Examples_39_0.png" />
</div>
</div>
<p>The contours above encircle the 68<span class="math notranslate nohighlight">\(^{th}\)</span> and 95<span class="math notranslate nohighlight">\(^{th}\)</span> percentiles of the number density of particles in bins along the x- and y-axis, effectively the 1- and 2-sigma dispersions, respectively.These percentage levels can be specified using the <code class="docutils literal notranslate"><span class="pre">percent</span></code> argument.</p>
<p>Rather than using different linestyles for the contours as is the default shown in the example above, a colormap can be mapped onto the contours where each line color is drawn from the colormap given to <code class="docutils literal notranslate"><span class="pre">cmap</span></code>.</p>
<p>If the bins are too finely, the resulting contours with appear quite jagged. This can be improved using the <code class="docutils literal notranslate"><span class="pre">smooth</span></code> parameter to apply a Gaussian kernel filter.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">splt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">naxes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="c1"># Cycle between different colors and linestyles</span>
<span class="n">splt</span><span class="o">.</span><span class="n">contourp</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">yvals</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span> <span class="n">percent</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">95</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
              <span class="n">linestyles</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">],</span>
              <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Smoothed contours with linestyle/color cycle&quot;</span><span class="p">)</span>

<span class="c1"># Generate contours with colours sampled from a colormap and smooth the resulting coontours.</span>
<span class="n">splt</span><span class="o">.</span><span class="n">contourp</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">yvals</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> <span class="n">percent</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">95</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span> <span class="n">smooth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
              <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cividis&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Smoothed contours sampled from a colormap&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_41_0.png" src="_images/Examples_41_0.png" />
</div>
</div>
</section>
</section>
<section id="Sector-Plots">
<h3>Sector Plots<a class="headerlink" href="#Sector-Plots" title="Permalink to this headline">¶</a></h3>
<p>Sector plots (a.k.a. “pizza slice” plots) are useful for plotting the spatial distribution of data containing one radial axis (r) and another corresponding to an angle (theta), typical of polar coordinates. This function creates a floating axis that can be rotated accordingly.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create some mock polar-coordinate data</span>
<span class="n">thetaArr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span><span class="n">high</span><span class="o">=</span><span class="mf">150.0</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">rArr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">cArr</span> <span class="o">=</span> <span class="mf">9.0</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span> <span class="n">rArr</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Basic sector plot defining the theta and radial limits</span>
<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">splt</span><span class="o">.</span><span class="n">sector</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="n">thetaArr</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">rArr</span><span class="p">,</span><span class="n">thetalim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">150.0</span><span class="p">),</span><span class="n">rlim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">),</span>
            <span class="n">rlabel</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span><span class="n">thetalabel</span><span class="o">=</span><span class="s2">&quot;RA&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_44_0.png" src="_images/Examples_44_0.png" />
</div>
</div>
<p>Under the hood, the data presented in a sector plot abides by the functionality of a scatter plot, hence the user can parse any parameters specific to <code class="docutils literal notranslate"><span class="pre">scatter()</span></code> into the <code class="docutils literal notranslate"><span class="pre">splotch.sector()</span></code> function. In the example below, a color axis is used to indicate the values of a third parameter.</p>
<p>Using the <code class="docutils literal notranslate"><span class="pre">rotate</span></code> parameter gives the user the ability to control the spatial orientation of the sector axis itself, see the second example below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Parse scatter() specific arguments into the sector plot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">splt</span><span class="o">.</span><span class="n">sector</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="n">thetaArr</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">rArr</span><span class="p">,</span> <span class="n">thetalim</span><span class="o">=</span><span class="p">(</span><span class="mf">20.0</span><span class="p">,</span><span class="mf">180.0</span><span class="p">),</span> <span class="n">rlim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">3.5</span><span class="p">),</span>
            <span class="n">rlabel</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="n">thetalabel</span><span class="o">=</span><span class="s2">&quot;RA&quot;</span><span class="p">,</span>
            <span class="n">c</span><span class="o">=</span><span class="n">cArr</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">25</span><span class="o">*</span><span class="n">rArr</span><span class="o">**</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Rotate the sector plot using the `rotate` argument</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">splt</span><span class="o">.</span><span class="n">sector</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="n">thetaArr</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">rArr</span><span class="p">,</span> <span class="n">thetalim</span><span class="o">=</span><span class="p">(</span><span class="mf">20.0</span><span class="p">,</span><span class="mf">160.0</span><span class="p">),</span> <span class="n">rlim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">),</span>
            <span class="n">rlabel</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="n">thetalabel</span><span class="o">=</span><span class="s2">&quot;RA&quot;</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span>
            <span class="n">c</span><span class="o">=</span><span class="n">cArr</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">25</span><span class="o">*</span><span class="n">rArr</span><span class="o">**</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_46_0.png" src="_images/Examples_46_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_46_1.png" src="_images/Examples_46_1.png" />
</div>
</div>
</section>
</section>
<section id="Axis-specific-Functions">
<h2>Axis-specific Functions<a class="headerlink" href="#Axis-specific-Functions" title="Permalink to this headline">¶</a></h2>
<section id="Figure-Subplots">
<h3>Figure Subplots<a class="headerlink" href="#Figure-Subplots" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code> function within matplotlib is sufficient to create an N<span class="math notranslate nohighlight">\(\times\)</span>M grid of axis subplots within a figure. However, if one wishes to create a set of axes that cannot be represented in the usual NxM layout (e.g. <code class="docutils literal notranslate"><span class="pre">naxes</span> <span class="pre">=</span> <span class="pre">7</span></code>), your options are limited. The <code class="docutils literal notranslate"><span class="pre">splotch.subplots()</span></code> function allows the user to specify an arbitrary number of axes in numerous orientations made up of N rows <span class="math notranslate nohighlight">\(\times\)</span> M columns.</p>
<p>Here’s how the <code class="docutils literal notranslate"><span class="pre">naxes</span></code> feature looks in practice:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Specifying an arbitrary number of axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">splt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">naxes</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span> <span class="c1"># to avoid overlap of labels and ticks</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_49_0.png" src="_images/Examples_49_0.png" />
</div>
</div>
<section id="Axis-alignments-with-splotch.subplots()">
<h4>Axis alignments with splotch.subplots()<a class="headerlink" href="#Axis-alignments-with-splotch.subplots()" title="Permalink to this headline">¶</a></h4>
<p>In the case of <code class="docutils literal notranslate"><span class="pre">naxes=7</span></code>, there are various configurations for this particular 2 <span class="math notranslate nohighlight">\(\times\)</span> 4 grid that one could imagine placing the 7 subplots within. This functionality is controlled using the <code class="docutils literal notranslate"><span class="pre">ha</span></code> (horizontal alignment) and <code class="docutils literal notranslate"><span class="pre">va</span></code> (vertical alignment) arguments. <code class="docutils literal notranslate"><span class="pre">ha</span></code> accepts ‘left’, ‘right’ and ‘center’, whereas <code class="docutils literal notranslate"><span class="pre">va</span></code> accepts ‘top’, ‘bottom’ and ‘center’.</p>
<p>Here are a few examples of different subplots configurations:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># horizontal alignment: left;  vertical alignment: top (Defaults)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">splt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">naxes</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">hspace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;ha = left, va = top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span> <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.45</span><span class="p">,</span><span class="mf">0.45</span><span class="p">,</span><span class="n">ii</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>

<span class="c1"># horizontal alignment: right;  vertical alignment: bottom</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">splt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">naxes</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">hspace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;ha = right, va = bottom&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span> <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.45</span><span class="p">,</span><span class="mf">0.45</span><span class="p">,</span><span class="n">ii</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>

<span class="c1"># horizontal alignment: centre;  vertical alignment: bottom (with two columns)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">splt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">naxes</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;centre&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span><span class="n">hspace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;ha = left, va = centre&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span> <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.45</span><span class="p">,</span><span class="mf">0.45</span><span class="p">,</span><span class="n">ii</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_51_0.png" src="_images/Examples_51_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_51_1.png" src="_images/Examples_51_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_51_2.png" src="_images/Examples_51_2.png" />
</div>
</div>
</section>
<section id="Notes-on-splotch.subplots()">
<h4>Notes on splotch.subplots()<a class="headerlink" href="#Notes-on-splotch.subplots()" title="Permalink to this headline">¶</a></h4>
<p>Note that the alignments chosen also impact the order in which each axis instance are arranged within the <code class="docutils literal notranslate"><span class="pre">axes</span></code> array that is returned. Whilst the user can specify any combination of <code class="docutils literal notranslate"><span class="pre">naxes</span></code>, <code class="docutils literal notranslate"><span class="pre">nrows</span></code> and <code class="docutils literal notranslate"><span class="pre">ncols</span></code>, the function will raise an exception if <code class="docutils literal notranslate"><span class="pre">nrows*ncols</span> <span class="pre">!=</span> <span class="pre">naxes</span></code>. The only combination of <code class="docutils literal notranslate"><span class="pre">ha</span></code> and <code class="docutils literal notranslate"><span class="pre">va</span></code> that is not allowed is when both are specified as ‘centre’, as in addition to being nonsensical in most cases, also raises an ambiguiety in the ordering in the resulting
array of subplots.</p>
</section>
</section>
<section id="Cornerplots">
<h3>Cornerplots<a class="headerlink" href="#Cornerplots" title="Permalink to this headline">¶</a></h3>
<p>Cornerplots are a useful tool for visualising multi-dimensional samples in one- and two-dimensional prokections to reveal covariances the data. These are commonplace for displaying the results of a Markov Chain Monte Carlo optimisation of a set of covariate parameters in a model.</p>
<p>A basic example is shown below.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># for storing columns in a data frame</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create some mock data</span>
<span class="n">ndim</span> <span class="o">=</span> <span class="mi">6</span> <span class="c1"># Number of dimensions in the data</span>
<span class="n">nsamples</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># the number of independent samples in, for example, an MCMC chain</span>

<span class="n">data1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">ndim</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">nsamples</span> <span class="o">//</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">nsamples</span> <span class="o">//</span> <span class="mi">5</span><span class="p">,</span> <span class="n">ndim</span><span class="p">])</span>
<span class="n">data2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">ndim</span><span class="p">)[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">ndim</span> <span class="o">*</span> <span class="n">nsamples</span> <span class="o">//</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span> <span class="n">nsamples</span> <span class="o">//</span> <span class="mi">5</span><span class="p">,</span> <span class="n">ndim</span><span class="p">]))</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Alpha&#39;</span><span class="p">,</span><span class="s1">&#39;Beta&#39;</span><span class="p">,</span><span class="s1">&#39;Gamma&#39;</span><span class="p">,</span><span class="s1">&#39;Delta&#39;</span><span class="p">,</span><span class="s1">&#39;Epsilon&#39;</span><span class="p">,</span><span class="s1">&#39;Zeta&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">splt</span><span class="o">.</span><span class="n">cornerplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Alpha&#39;</span><span class="p">,</span><span class="s1">&#39;Beta&#39;</span><span class="p">,</span><span class="s1">&#39;Delta&#39;</span><span class="p">,</span><span class="s1">&#39;Zeta&#39;</span><span class="p">],</span>
                <span class="n">nsamples</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span><span class="n">pair_type</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;hist2D&#39;</span><span class="p">,</span><span class="s1">&#39;contour&#39;</span><span class="p">],</span>
                <span class="n">hist_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">),</span>
                <span class="n">hist2D_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cividis&#39;</span><span class="p">),</span>
                <span class="n">contour_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">percent</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">95</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">7</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cividis&#39;</span><span class="p">,</span><span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">smooth</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span><span class="n">plabel</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># Use splotch.adjust_text() to modify the x/y labels and tick labels of all subplots at the same time</span>
<span class="n">splt</span><span class="o">.</span><span class="n">adjust_text</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;xyk&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_56_0.png" src="_images/Examples_56_0.png" />
</div>
</div>
<p>Note that the user can specify what type of 2D representation of the data (either scatter, hist2D or contour) should be displayed on one (or both) of the off-diagonal corners. To modify the arguments of these individual plot types, simply parse a corresponding keyword dictionary for each, i.e. <code class="docutils literal notranslate"><span class="pre">scatter_kw</span></code>, <code class="docutils literal notranslate"><span class="pre">hist2D_kw</span></code> or <code class="docutils literal notranslate"><span class="pre">contour_kw</span></code>.</p>
<p>Let’s now try an example with the <code class="docutils literal notranslate"><span class="pre">emcee</span></code> MCMC optimisation package.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">emcee</span>

<span class="c1"># Define the log probability function to minimise</span>
<span class="k">def</span> <span class="nf">log_prob</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">cov</span><span class="p">):</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">mu</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">cov</span><span class="p">,</span> <span class="n">diff</span><span class="p">)))</span>

<span class="n">ndim</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">ndim</span><span class="p">)</span>

<span class="c1"># Create a covariance matrix across the N-dimensional space</span>
<span class="n">cov</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">ndim</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">ndim</span><span class="p">,</span> <span class="n">ndim</span><span class="p">))</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>
<span class="n">cov</span> <span class="o">+=</span> <span class="n">cov</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">cov</span><span class="o">.</span><span class="n">diagonal</span><span class="p">())</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">cov</span><span class="p">,</span> <span class="n">cov</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Now let&#39;s perform the MCMC optimisation</span>
<span class="n">nwalkers</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">p0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nwalkers</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)</span> <span class="c1"># a matrix of 32 walkers each with 5 random guesses for the parameters</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">emcee</span><span class="o">.</span><span class="n">EnsembleSampler</span><span class="p">(</span><span class="n">nwalkers</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">log_prob</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">means</span><span class="p">,</span> <span class="n">cov</span><span class="p">])</span>

<span class="n">state</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">run_mcmc</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">sampler</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

<span class="n">sampler</span><span class="o">.</span><span class="n">run_mcmc</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">get_chain</span><span class="p">(</span><span class="n">flat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">samples</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Alpha&quot;</span><span class="p">,</span><span class="s2">&quot;Beta&quot;</span><span class="p">,</span><span class="s2">&quot;Gamma&quot;</span><span class="p">,</span><span class="s2">&quot;Delta&quot;</span><span class="p">,</span><span class="s2">&quot;Epsilon&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">splt</span><span class="o">.</span><span class="n">cornerplot</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">nsamples</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span><span class="n">pair_type</span><span class="o">=</span><span class="s1">&#39;contour&#39;</span><span class="p">,</span>
                <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;alpha, $</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">,</span><span class="s1">&#39;beta, $</span><span class="se">\\</span><span class="s1">beta$&#39;</span><span class="p">,</span><span class="s1">&#39;gamma, $</span><span class="se">\\</span><span class="s1">gamma$&#39;</span><span class="p">,</span><span class="s1">&#39;delta, $</span><span class="se">\\</span><span class="s1">delta$&#39;</span><span class="p">,</span><span class="s1">&#39;epsilon, $</span><span class="se">\\</span><span class="s1">epsilon$&#39;</span><span class="p">],</span>
                <span class="n">hist_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">40</span><span class="p">),</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                <span class="n">contour_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">smooth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">percent</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greens&#39;</span><span class="p">,</span><span class="n">plabel</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="n">splt</span><span class="o">.</span><span class="n">adjust_text</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;xyk&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_60_0.png" src="_images/Examples_60_0.png" />
</div>
</div>
</section>
<section id="Adjusting-Text-in-Splotch">
<h3>Adjusting Text in Splotch<a class="headerlink" href="#Adjusting-Text-in-Splotch" title="Permalink to this headline">¶</a></h3>
<p>Text within plots can be treated as its own separate entity. As such, Splotch provides the <code class="docutils literal notranslate"><span class="pre">adjust_text()</span></code> function as a way to have overarching control over all text objects within a plot. This function can apply one (or many) adjustments to the text properties of any number of text instances. The different types of text instances accessible by <code class="docutils literal notranslate"><span class="pre">adjust_text()</span></code> are specified using the <code class="docutils literal notranslate"><span class="pre">which</span></code> argument and include:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>* &#39;x&#39;|&#39;xlabel&#39;   : x-axis label
* &#39;y&#39;|&#39;ylabel&#39;   : y-axis label
* &#39;t&#39;|&#39;title&#39;    : Title
* &#39;s&#39;|&#39;suptitle&#39; : Super-title (Not implemented)
* &#39;l&#39;|&#39;legend&#39;   : Legend text
* &#39;c&#39;|&#39;colorbar&#39; : Color bar (Limited to a single colorbar)
* &#39;T&#39;|&#39;text&#39;     : Text objects
* &#39;a&#39;|&#39;all&#39;      : All instances of all the above
</pre></div>
</div>
<p>Below, are several rather exuberant usages of the <code class="docutils literal notranslate"><span class="pre">splotch.adjust_text()</span></code> function.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create some mock data representing two multi-variate 2D Gaussians</span>
<span class="n">num</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">xvals</span><span class="p">,</span> <span class="n">yvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">],[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span><span class="n">size</span><span class="o">=</span><span class="n">num</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">### Plot some data with lots of text intances</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">splt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">14</span><span class="p">))</span>

<span class="n">splt</span><span class="o">.</span><span class="n">hist2D</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span><span class="n">yvals</span><span class="p">,</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x data&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;y data&quot;</span><span class="p">,</span>
            <span class="n">clabel</span><span class="o">=</span><span class="s2">&quot;Number density&quot;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;2D Histogram&quot;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">splt</span><span class="o">.</span><span class="n">contourp</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span><span class="n">yvals</span><span class="p">,</span><span class="n">percent</span><span class="o">=</span><span class="p">[</span><span class="mf">68.3</span><span class="p">,</span><span class="mf">95.5</span><span class="p">,</span><span class="mf">99.7</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="n">lab_loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
              <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x data&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;y data&quot;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Contour Plot&quot;</span><span class="p">,</span>
              <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">text1</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="s2">&quot;This is a piece of text!&quot;</span><span class="p">)</span>
<span class="n">text2</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;This is another piece of text!&quot;</span><span class="p">)</span>
<span class="n">text3</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="s2">&quot;This is the final piece of text!&quot;</span><span class="p">)</span>
<span class="n">text4</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="s2">&quot;Look at me, I am some text!&quot;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>


<span class="c1">### Using splotch.adjust_text() ###</span>

<span class="c1"># Adjust x and y labels on all axes</span>
<span class="n">splt</span><span class="o">.</span><span class="n">adjust_text</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>

<span class="c1"># Adjust title font on only one axis</span>
<span class="n">splt</span><span class="o">.</span><span class="n">adjust_text</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">)</span>

<span class="c1"># Adjust colorbar font</span>
<span class="n">splt</span><span class="o">.</span><span class="n">adjust_text</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">fontstyle</span><span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span><span class="n">fontvariant</span><span class="o">=</span><span class="s1">&#39;small-caps&#39;</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>

<span class="c1"># Adjust labels in legend</span>
<span class="n">splt</span><span class="o">.</span><span class="n">adjust_text</span><span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span><span class="n">backgroundcolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Adjust all text instances in an axis.</span>
<span class="n">splt</span><span class="o">.</span><span class="n">adjust_text</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;limegreen&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1">#... or adjust a specific Text object</span>
<span class="n">splt</span><span class="o">.</span><span class="n">adjust_text</span><span class="p">(</span><span class="n">text4</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;goldenrod&#39;</span><span class="p">,</span><span class="n">backgroundcolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_63_0.png" src="_images/Examples_63_0.png" />
</div>
</div>
<p>All of the above could be achieved in a single-line if desired</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">splt</span><span class="o">.</span><span class="n">adjust_text</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">text4</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="p">[</span><span class="mi">22</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">22</span><span class="p">],</span>
                 <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;goldenrod&#39;</span><span class="p">],</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>

</pre></div>
</div>
</div>
</section>
</section>
<section id="Keyword-arguments-are-you-friend">
<h2>Keyword arguments are you friend<a class="headerlink" href="#Keyword-arguments-are-you-friend" title="Permalink to this headline">¶</a></h2>
<p>One of the core features of Splotch is that at its core, it is a wrapper around matplotlib.pyplot. This gives the user complete access to not only the Splotch-specific functionalities (e.g. <code class="docutils literal notranslate"><span class="pre">xlabel</span></code>, <code class="docutils literal notranslate"><span class="pre">title</span></code>, <code class="docutils literal notranslate"><span class="pre">grid</span></code>, etc.), but also access to all of the underlying <code class="docutils literal notranslate"><span class="pre">pyplot</span></code> parameters using keyword arguments (kwargs). One can use the <code class="docutils literal notranslate"><span class="pre">plot_kw</span></code> (or <code class="docutils literal notranslate"><span class="pre">test_kw</span></code>, <code class="docutils literal notranslate"><span class="pre">bar_kw</span></code>, etc.) parameter to provide a dictionary of <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> specific arguments that are parsed into the corresponding
matplotlib plotting function. Alternatively, simply specifying the parameters as they are named within pyplot functions will be collate them together into a dictionary of kwargs that acts the same as though they were specified explicitly in <code class="docutils literal notranslate"><span class="pre">plot_kw</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span><span class="n">axes</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="c1"># Basic plot explicitly using plot_kw dictionary</span>
<span class="n">kw_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
               <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
               <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span>
               <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;darkgreen&#39;</span><span class="p">,</span>
               <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
               <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="c1"># feed the kw_dict *explicitly* into any splotch function</span>
<span class="n">splt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xdata</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">ydata</span><span class="p">,</span><span class="n">xlog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x danp.linspace(-0.5,0.5,1000)ta&quot;</span><span class="p">,</span>
          <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;y data&quot;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Using plot_kw dictionary&quot;</span><span class="p">,</span><span class="n">plot_kw</span><span class="o">=</span><span class="n">kw_dict</span><span class="p">)</span>

<span class="c1"># Basic plot *implicitly* referencing pyplot parameters which will be given as keyword arguments</span>
<span class="n">splt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xdata</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">ydata</span><span class="p">,</span><span class="n">xlog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x data&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;y data&quot;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Using **kwargs&quot;</span><span class="p">,</span>
          <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;goldenrod&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_67_0.png" src="_images/Examples_67_0.png" />
</div>
</div>
<section id="A-complex-plot-using-**kwargs">
<h3>A complex plot using **kwargs<a class="headerlink" href="#A-complex-plot-using-**kwargs" title="Permalink to this headline">¶</a></h3>
<p>The full potential of using kwargs to specify plotting parameters can be seen in the example scatterplot below.</p>
<p>Remember: <strong>same outcome, in a single line</strong>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">splt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="c1">### Using unnecessarily many kwargs to make a plot.</span>
<span class="n">splt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xdata</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">ydata</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">cdata</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;summer&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;A label&quot;</span><span class="p">,</span>
             <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x data&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;y data&quot;</span><span class="p">,</span><span class="n">clabel</span><span class="o">=</span><span class="s1">&#39;z data&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;A complex plot&quot;</span><span class="p">,</span>
             <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">hatch</span><span class="o">=</span><span class="s1">&#39;//////&#39;</span><span class="p">,</span>
             <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span><span class="n">plotnonfinite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Examples_69_0.png" src="_images/Examples_69_0.png" />
</div>
</div>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Overview</a><ul>
<li><a class="reference internal" href="#The-Basics">The Basics</a></li>
<li><a class="reference internal" href="#1-Dimensional-Plots">1-Dimensional Plots</a><ul>
<li><a class="reference internal" href="#A-Simple-plot-using-matplotlib">A Simple plot using matplotlib</a></li>
<li><a class="reference internal" href="#Basic-histograms">Basic histograms</a></li>
<li><a class="reference internal" href="#Broken-axis-plots">Broken axis plots</a></li>
<li><a class="reference internal" href="#Axis-lines-and-Curves">Axis lines and Curves</a><ul>
<li><a class="reference internal" href="#The-generalised-axline-function">The generalised axline function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Generalised-curves-based-on-expressions">Generalised curves based on expressions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#2-Dimensional-Plots">2-Dimensional Plots</a><ul>
<li><a class="reference internal" href="#2D-Images-and-Colorbars">2D Images and Colorbars</a></li>
<li><a class="reference internal" href="#Scatter-Plots">Scatter Plots</a></li>
<li><a class="reference internal" href="#2D-Histograms">2D Histograms</a><ul>
<li><a class="reference internal" href="#Binned-statistics-in-one-and-two-dimensional-histograms">Binned statistics in one and two-dimensional histograms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Contour-plots">Contour plots</a><ul>
<li><a class="reference internal" href="#Percentile-Contour-Plots:">Percentile Contour Plots:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Sector-Plots">Sector Plots</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Axis-specific-Functions">Axis-specific Functions</a><ul>
<li><a class="reference internal" href="#Figure-Subplots">Figure Subplots</a><ul>
<li><a class="reference internal" href="#Axis-alignments-with-splotch.subplots()">Axis alignments with splotch.subplots()</a></li>
<li><a class="reference internal" href="#Notes-on-splotch.subplots()">Notes on splotch.subplots()</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Cornerplots">Cornerplots</a></li>
<li><a class="reference internal" href="#Adjusting-Text-in-Splotch">Adjusting Text in Splotch</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Keyword-arguments-are-you-friend">Keyword arguments are you friend</a><ul>
<li><a class="reference internal" href="#A-complex-plot-using-**kwargs">A complex plot using **kwargs</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="base_func.html"
                        title="previous chapter">splotch base functions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="changelog.html"
                        title="next chapter">Changelog for Splotch</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Examples.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="changelog.html" title="Changelog for Splotch"
             >next</a> |</li>
        <li class="right" >
          <a href="base_func.html" title="splotch base functions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">splotch 0.5.6.6 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Overview</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Matías Bravo &amp; Robin Cook.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.1.
    </div>
  </body>
</html>